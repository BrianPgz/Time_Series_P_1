---
title: "Beer"
author: "Brian Perez G"
date: "14/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown


```{r echo=FALSE}
library(forecast)
library(timeSeries)
library(nortest)
library(tseries)
library(TSA)
library(lmtest)
library(ggplot2)

```



```{r echo=TRUE}
Data_beer= read.csv(file = "monthly_beer.csv")
```

```{r echo=TRUE}
head(Data_beer)
```

Tenemos $Data_beer$ en data frame tenemos que tener el formato de serie de tiempo. 

Vamos a obtener la primera y la última fecha.

```{r echo=TRUE}
tamanio_base = length(Data_beer$Month)
```
Tenemos que la base tiene 476 datos. 

```{r echo=TRUE}
Data_beer$Month[1]
Data_beer$Month[476]
```
La base tiene fecha de inicio en enero de 1956 y fin en agosto de 1995. Vamos a crear el objeto serie de tiempo.

```{r echo=TRUE}
S_beer = ts(Data_beer$Monthly.beer.production, start = c(1956, 1), end = c(1995, 8), frequency = 12)
S_beer
```

Vamos a visualizar la serie de tiempo. 

```{r echo=TRUE}
ts.plot(S_beer,main = "Serie de tiempo de producción mensual de cerveza")
```

Obtengamos algunas medidas importantes. 

```{r echo=TRUE}
mean(S_beer)
var(S_beer)
sd(S_beer)
```
Veamos los correlogramas de la serie de tiempo. 
```{r echo=TRUE}
tsdisplay(S_beer, main = "Serie de tiempo de producción mensual de cerveza")
```

Observamos varianza creciente, al principio se ve puede observar tendencia pero cerca de 1980 se rompe la tendencia, o bien, la tendencia cambia. 

En el $ACF$ Observamos alta correlación y que además no decae la correlación de manera exponencial. Para el $PACF$ observamos que la correlación parcial sigue siendo alta y por ello aproximadamente 15 barras se salen de las barras de confianza.  


Podemos observar ciclos con un periodo igual a 12. 

```{r echo=TRUE}
desc_datos = decompose(S_beer)
plot(desc_datos)   

```
Observamos que la tendencia cambia y tenemos ciclos, además del componente aleatorio. Vamos a hacer pruebas, y si es el caso haremos transformaciones para arreglar la serie.   

Haciendo el $bp \ test$ vamos a contrastar la varianza. 

$Ho:$ La varianza es constante (Homocedasticidad)   $vs.$  $H1:$ La varianza no es constate (Heterocedasticidad)

```{r echo=TRUE}
t1=seq(1956,1995.59,by=1/12)
bptest( S_beer ~ t1)  
```

Con un $p-value$ de casi cero entonces rechazamos $Ho$, entonces tenemos varianza no constante. 

Vamos a hacer la prueba de Dickey-Fuller

$Ho:$ La serie no es estacionaria $vs.$ $H1:$ La serie es estacionaria


```{r echo=TRUE}
adf.test(S_beer) 
```
Con un $p-value = 0.01$, y un nivel de confianza del $.05$, rechazamos hipótesis nula, entonces es estacionaria. 

Para el periodo vamos a usar la función $cycle()$

```{r echo=TRUE}
cycle(S_beer) 
```








































